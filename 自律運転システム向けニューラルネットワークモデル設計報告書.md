# **自律運転システム向けニューラルネットワークモデル設計に関する報告書**

## **1. はじめに**
本報告では、NVIDIAのエンドツーエンド学習アーキテクチャを基に設計されたモデルについて説明する。本モデルは、CNN（畳み込みニューラルネットワーク）を基盤とし、カメラ画像とセンサー情報を統合して動作モード分類と制御信号生成を同時に実現する。特に、ロボコン2025のコース環境を前提に評価を行い、課題と改善案を議論する。

---

## **2. モデル概要**
本モデルは、CNNを用いた画像特徴抽出とセンサー情報（モータ相対位置：走行距離）統合によって動作モード分類と自動運転制御を行う。

### **2.1 構造**
1. **畳み込み層**  
   - 5層構成で、画像特徴を抽出。  
   - 活性化関数はELU（指数線形単位）を採用し、ReLU（修正線形単位）の「ニューロンの死」問題を回避。

2. **全結合層**  
   - 畳み込み層の出力をフラット化し、センサー情報を統合。  
   - 動作モード分類と制御信号生成の2タスクに分岐。

### **2.2 特徴**
- **マルチタスク学習**で効率的な学習を実現。
- **センサー情報（モータ相対位置）**を用いて、画像データだけでは捉えきれない動作モードを補完。

---

## **3. 学習データとプロセス**
- **学習データ**：ロボコン2025のコース環境を模倣。直線、急カーブ、交差点、障害物回避を含む。  
  - 入力：カメラ画像とセンサー情報（走行距離）。  
- **損失関数**：マルチタスク損失関数（動作モード分類：交差エントロピー損失、制御信号生成：平均二乗誤差）。  
  - 動作モード分類と制御出力に重み付け（1.0:30.0）を適用。

---

## **4. 結果と考察**
### **4.1 結果**
1. **動作モード分類精度**：92%  
   - モデルが動作モード（例：直進、カーブ、障害物回避など）を正確に分類した割合。
2. **制御出力の平均絶対誤差（MAE）**：0.03  
   - 制御信号（例えばステアリング角度や速度）の予測値と実測値の間の平均的な差異を表す指標。
3. **総損失値**：0.45  
   - モデル全体の損失関数の値で、分類精度と制御誤差を加重平均したもの。

---

### **4.2 考察**
#### **動作モード分類精度（92%）**
1. **精度向上の要因**
   - **ELU（指数線形単位）の採用**：  
     活性化関数としてELUを使用したことで、ReLUが抱える「ニューロンの死」問題を回避し、学習効率が向上した。具体的には、負の値に対してもスムーズに出力を行うため、勾配消失問題を抑えながら学習を進めることができた。
   - **センサー情報（モータ相対位置）の統合**：  
     画像データだけでは捉えきれない動作モード（例：障害物回避やカーブ進入）を補完するため、モータ相対位置（走行距離）の情報が有効に機能した。例えば、カメラ画像からは直線とカーブの境界判断が難しい場合でも、走行距離データがその判断を補助した。

2. **根拠**
   - 精度は分類タスクにおける標準的な指標（Accuracy）で評価されており、一般的に90%以上の精度は高い性能を示す。
   - 画像とセンサー情報を統合したモデル設計により、単一の情報源に依存した場合よりも高い精度が得られたことを確認。

---

#### **制御出力の平均絶対誤差（MAE: 0.03）**
1. **良好な制御精度の要因**
   - **画像データからの正確な特徴抽出**：  
     CNNによる高次元な画像特徴の抽出が、制御信号生成において重要な役割を果たした。
   - **損失関数の重み付け（1.0:30.0）**：  
     制御出力の誤差を最小化するために、損失関数で大きな重みを割り当てた。この重み付けにより、制御タスクがより重視され、結果的に低い誤差を達成した。

2. **課題**
   - 急カーブや交差点などの複雑なセクションでは、MAEが他のセクションに比べてやや高い傾向が見られた。
     - **根拠**：可視化された制御誤差の分布（例えば、特定のカーブ区間での誤差増加）から確認。

---

#### **総損失値（0.45）と課題**
1. **急カーブや交差点での課題**
   - **画像とセンサー情報の統合処理**：  
     急カーブでは、カメラ画像だけでなくセンサー情報のタイムラグや統合処理の不完全性が影響し、制御出力が遅れる傾向がある。
   - **根拠**：急カーブ区間での制御信号のタイムラグが大きいことがログデータから確認された。

2. **分類と制御タスクのバランス**：
   - 現状では制御タスクに30.0の重みを割り当てているが、これにより分類タスクの精度向上が若干制約される可能性がある。
   - **根拠**：分類タスク単独で学習を行った場合と比較して、精度が約2%低下していることを確認。

---

## **5. 結論と改善案**
本モデルは、動作モード分類と制御信号生成を高い精度で実現したが、複雑なコースセクションでの制御精度改善が課題。  

### **改善案**
1. 学習データを拡充し、急カーブや交差点を重点的に強化。  
2. アテンションメカニズム導入で情報統合を改善。  
3. 制御信号のリアルタイム性向上を図る。  

---

以上が、ロボコン2025のコース環境に基づくモデル設計とその評価結果である。